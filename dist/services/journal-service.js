class JournalService{constructor(){this.defaultPage="journal"}init(){this.renderJournal()}renderJournal=e=>{const t=document.querySelector("#journal"),n=t.querySelector(".journal-modal-wrapper"),a=(n.querySelector(".modal"),t.querySelector(".add-journal-modal")),l=a.querySelector(".modal"),d=t.querySelector(".add-journal-modal .form"),r=t.querySelector(".add-journal-close"),o=t.querySelector(".edit-journal-modal"),i=o.querySelector(".modal"),s=t.querySelector(".edit-journal-modal .form"),c=t.querySelector(".edit-journal-close"),u=t.querySelector(".journal__list"),v=db.collection("journal"),y=t.querySelector(".add-journal");let m;const f=()=>{l.style.cssText="animation: slideDown .5s ease; animation-fill-mode: forwards;",setTimeout((()=>{a.style.display="none"}),500)},p=()=>{i.style.cssText="animation: slideDown .5s ease; animation-fill-mode: forwards;",setTimeout((()=>{o.style.display="none"}),500)},S=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],g=["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],j=e=>{const t=e.data(),n=new Date(t.date),a=`${S[n.getDay()]} ${n.getDate()}.${g[n.getMonth()]} ${n.getFullYear()}`,l=`\n          \x3c!-- START test card --\x3e\n           <div class="card card--journal" data-id='${e.id}'>\n              <div class='card__container'>\n                <div class='card__header'>\n                    <hr hidden></hr>\n                    <p class='card__header--date'>${a}</p>\n                </div>\n                \n                <div class='card-content'>\n                  <div title='Feeling ${t.feeling}' class='card-content__feeling'>\n                      <i class='tc-icons-${t.feeling}'></i>\n                  </div>\n                  \n                  <div id='description' class="card-content__entry">\n                    <div>\n                      <p>${t.entry}</p>\n                      <div class='avatar'><p>${t.user}</p></div>\n\t\t\t\t\t\t\t\t\t\t\t<button class="edit-journal btn-circle--edit"></button>\n                    </div>\n                    </div>\n                </div>\n       \n                <div class='see-more'>\n                <hr></hr>\n                  <button class="btn btn-secondary btn-open">See more</button>\n                </div>\n              </div>\n            </div>\n\t\t\t`;u.insertAdjacentHTML("beforeend",l);document.querySelector(`[data-id='${e.id}'] .edit-journal`).addEventListener("click",(()=>{o.style.display="flex",i.style.cssText="animation: slideUp .5s ease; animation-fill-mode: forwards;",console.log(t.user),m=e.id,s.feeling.value=t.feeling,s.entry.value=t.entry,s.date.value=t.date,s.user.value=t.user}));document.querySelector(`[data-id='${e.id}'] .delete-journal`).addEventListener("click",(()=>{v.doc(`${e.id}`).delete().then((()=>{console.log("Document succesfully deleted!")})).catch((e=>{console.log("Error removing document",e)}))}))};y.addEventListener("click",(()=>{a.style.display="flex",l.style.cssText="animation: slideUp .5s ease; animation-fill-mode: forwards;",d.feeling.value="",d.entry.value="",d.date.value="",d.user.value=""})),r.addEventListener("click",(e=>{e.preventDefault(),f()})),c.addEventListener("click",(e=>{e.preventDefault(),p()})),window.addEventListener("click",(e=>{e.target===a&&f(),e.target===o&&p()})),v.onSnapshot((e=>{e.docChanges().forEach((e=>{if("added"===e.type&&setTimeout((()=>{j(e.doc)}),500),"removed"===e.type){let t=document.querySelector(`[data-id='${e.doc.id}']`);t.parentElement.removeChild(t)}if("modified"===e.type){let t=document.querySelector(`[data-id='${e.doc.id}']`);t.parentElement.removeChild(t),j(e.doc)}}))})),d.addEventListener("submit",(e=>{e.preventDefault(),v.add({feeling:d.feeling.value,entry:d.entry.value,date:d.date.value,user:d.user.value}),f()})),s.addEventListener("submit",(e=>{e.preventDefault(),v.doc(m).update({feeling:s.feeling.value,entry:s.entry.value,date:s.date.value,user:s.user.value}),p()}))}}const journalService=new JournalService;export default journalService;
//# sourceMappingURL=journal-service.js.map